#include <stdio.h>

void write_file(
    char *filepath, 
    unsigned char *prefix,
    unsigned char *vec,
    unsigned char *suffix,
    int prefix_nbytes, int vec_nbytes, int suffix_nbytes
){
    FILE *ptr;
     
    ptr = fopen(filepath,"wb");
    fwrite(prefix, sizeof(unsigned char), prefix_nbytes, ptr);
    fwrite(vec, sizeof(unsigned char), vec_nbytes, ptr);
    fwrite(suffix, sizeof(unsigned char), suffix_nbytes, ptr);
    fclose (ptr);
}

int main(){
    char good_out_filepath[] = "good.py";
    char evil_out_filepath[] = "evil.py";

    int vec_nbytes = 128, template_init_nbytes=64, template_end_nbytes=14;

    unsigned char template_init[64] = "#coding: L1\nprint('%s World!'%('Hello','Goodbye Cruel')[ord(\"\"\"\n";
    unsigned char template_end[14] = "\n\"\"\"[20])<90])";

    unsigned char vec1[128] = {
        0xc0, 0xa9, 0x97, 0x84, 0x1a, 0x38, 0x0e, 0x1a, 0xd6, 0x03, 0x5b, 0xd4, 0xad, 0x6f, 0x5c, 0xae,
        0x87, 0x8d, 0xe2, 0xd9, 0xbb, 0xa7, 0x4f, 0xbb, 0x41, 0xde, 0x41, 0x2a, 0x36, 0xfc, 0x94, 0x22,
        0x97, 0xee, 0xad, 0xcc, 0xec, 0x23, 0x6a, 0x79, 0x6b, 0x0e, 0x43, 0xd1, 0xc0, 0x17, 0x38, 0x35,
        0xd6, 0xe9, 0x38, 0x7c, 0xea, 0x08, 0x8d, 0xbb, 0xa9, 0x7b, 0x81, 0x6a, 0x7e, 0xf5, 0xc3, 0x93,
        0x78, 0x8f, 0xb2, 0x4a, 0x23, 0x51, 0x3d, 0xd5, 0x71, 0xdc, 0xc1, 0xa2, 0x3d, 0xe7, 0xb0, 0x5d,
        0x42, 0x62, 0x3d, 0x76, 0x17, 0x36, 0xa0, 0x55, 0xcd, 0x77, 0x12, 0xcd, 0x59, 0x32, 0x5d, 0x22,
        0x47, 0x51, 0x57, 0x02, 0x69, 0x0b, 0x82, 0x70, 0xb3, 0x90, 0xcc, 0xef, 0x59, 0x69, 0x56, 0x82,
        0xc0, 0x9c, 0xeb, 0xa9, 0x4c, 0x66, 0x7a, 0xb0, 0xc3, 0x26, 0xd6, 0x85, 0x25, 0x1b, 0xf6, 0xc7
    };

    unsigned char vec2[128] = {
        0xc0, 0xa9, 0x97, 0x84, 0x1a, 0x38, 0x0e, 0x1a, 0xd6, 0x03, 0x5b, 0xd4, 0xad, 0x6f, 0x5c, 0xae,
        0x87, 0x8d, 0xe2, 0x59, 0xbb, 0xa7, 0x4f, 0xbb, 0x41, 0xde, 0x41, 0x2a, 0x36, 0xfc, 0x94, 0x22,
        0x97, 0xee, 0xad, 0xcc, 0xec, 0x23, 0x6a, 0x79, 0x6b, 0x0e, 0x43, 0xd1, 0xc0, 0x97, 0x38, 0x35,
        0xd6, 0xe9, 0x38, 0x7c, 0xea, 0x08, 0x8d, 0xbb, 0xa9, 0x7b, 0x81, 0xea, 0x7e, 0xf5, 0xc3, 0x93,
        0x78, 0x8f, 0xb2, 0x4a, 0x23, 0x51, 0x3d, 0xd5, 0x71, 0xdc, 0xc1, 0xa2, 0x3d, 0xe7, 0xb0, 0x5d,
        0x42, 0x62, 0x3d, 0xf6, 0x17, 0x36, 0xa0, 0x55, 0xcd, 0x77, 0x12, 0xcd, 0x59, 0x32, 0x5d, 0x22,
        0x47, 0x51, 0x57, 0x02, 0x69, 0x0b, 0x82, 0x70, 0xb3, 0x90, 0xcc, 0xef, 0x59, 0xe9, 0x55, 0x82,
        0xc0, 0x9c, 0xeb, 0xa9, 0x4c, 0x66, 0x7a, 0xb0, 0xc3, 0x26, 0xd6, 0x05, 0x25, 0x1b, 0xf6, 0xc7
    };
    

    // write good file
    write_file(
        good_out_filepath, template_init, vec1, template_end, 
        template_init_nbytes, vec_nbytes, template_end_nbytes
    );

    // write bad file
    write_file(
        evil_out_filepath, template_init, vec2, template_end, 
        template_init_nbytes, vec_nbytes, template_end_nbytes
    );

    return(0);
}
